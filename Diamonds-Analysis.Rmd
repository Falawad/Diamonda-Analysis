---
title: "Diamonds Analysis"
author: "Fatimah Alawad"
date: "10/2/2021"
output: 'rmdformats::readthedown'
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

The dataset contains the following variables:

| Variable | Description                                 |
|----------|---------------------------------------------|
|price     | price in US dollars (\$326–\$18,823)        |
|carat     | weight of the diamond (0.2–5.01)            |
| cut      | quality of the cut (Fair, Good, Very Good, Premium, Ideal)|
| color    | diamond colour, from D (best) to J (worst)  |
| clarity  | a measurement of how clear the diamond is (I1 (worst), SI2, SI1, VS2, VS1, VVS2, VVS1, IF (best))               |
| x        | length in mm (0–10.74)                      |
| y        | width in mm (0–58.9)                        |
| z        | depth in mm (0–31.8)                        |
| depth    | total depth percentage = z / mean(x, y) = 2 * z / (x + y) (43–79)                                               |
| table    | width of top of diamond relative to widest point (43–95)                                                  |

```{r}
# load packages
library(rmdformats)
library(tidyverse)
```

# Descriptive Statistics

```{r, results = "asis"}
library(qwraps2)
options(qwraps2_markup = "markdown")


our_summary1 <-
  list("price" =
       list("Average"   = ~ mean(price),
            "SD"        = ~ sd(price)),
       "Carat" =
       list("Average"       = ~ mean(carat),
            "median"    = ~ median(carat),
            "SD"       = ~ sd(carat))
       )
table_one <- summary_table(diamonds, our_summary1)
table_one
```

# Inferential Statistics

```{r}

lin_model1 <- lm(price ~ ., data = diamonds)

summary(lin_model1)
```

From the summary of the linear model we can see that the width and the depth of the diamond are not statistically significant.

```{r}
lin_model <- lm(price ~ carat + cut + color + clarity + x + depth + table, data = diamonds)

summary(lin_model)


one.way <- aov(lin_model) 

anova_table <- summary.aov(one.way)

anova_table

```

# plots

```{r}
ggplot(diamonds, aes(carat, price, color = cut)) +
  geom_point(shape = 16 , alpha = 0.75, position = "jitter" ) +
  geom_smooth(method = "lm", se = FALSE) +
  scale_color_brewer(palette = "Dark2" )+
  labs(x = "The Carat of the diamond",
       y = "The Price of the diamond",
       color = "Diamond's cut"
       )+
  theme_classic() +
  theme(rect = element_blank(),
        legend.position = c(0.1, 0.9))+
  NULL
```
The plot shows that as the weight of the diamond(carat) increases the price increases. Also, it is increases when the quality of the cut increases if we consider that 1 = Fair, 2 = Good, 3 = Very Good, 4 = Premium, 5 = Ideal.

# What is the average diamond price in each category of cut and color?

```{r}
diamonds %>% 
  group_by(cut, color) %>% 
  summarise(average = mean(price))

ggplot(diamonds, aes(fill = factor(color), mean(price))) +
  geom_bar(position = "dodge") +
  NULL


```

